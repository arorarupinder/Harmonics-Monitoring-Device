#Peripheral Code

import machine
import time

#Configure pins
spi_sck = machine.Pin(18)
spi_tx = machine.Pin(19)
spi_rx = machine.Pin(16)

#Configure SPI bus as slave
spi = machine.SPI(0, baudrate = 9600, polarity = 0, phase = 0, sck = spi_sck, mosi = spi_tx, miso = spi_rx)

#initilaize led
led = machine.Pin(25, machine.Pin.OUT)

while True:
    #receive the state of the led from the central board
    received_value = spi.read(1)
    print(received_value)
    #toggle led based on the received value
    if received_value[0] ==1:
        led.value(True)
        print("on")
    else:
        led.value(False)
        print("off")
    
    #send the state of the led over the spi interface
    spi.write(bytes([led.value()]))
    
    time.sleep(1)
